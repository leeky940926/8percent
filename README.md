# ì›í‹°ë“œxìœ„ì½”ë“œ ë°±ì—”ë“œ í”„ë¦¬ì˜¨ë³´ë”© ê³¼ì œ4 :: 8í¼ì„¼íŠ¸(eightpercent)

# ë°°í¬ ì£¼ì†Œ : 3.143.233.195:8000

### 1. [TEAM] WithCODE

#### Members

| ì´ë¦„   | github                         |
| ------ | ------------------------------ |
| ê¹€ë¯¼í˜¸ | https://github.com/maxkmh712   |
| ê¹€ì£¼í˜• | https://github.com/BnDC        |
| ë°•ì¹˜í›ˆ | https://github.com/chihunmanse |
| ë°•í˜„ìš° | https://github.com/Pagnim      |
| ì´ê¸°ìš© | https://github.com/leeky940926 |
| ì´ì •ì•„ | https://github.com/wjddk97     |

------

### 2. ê³¼ì œ

#### [í•„ìˆ˜ í¬í•¨ ì‚¬í•­]

- READ.ME ì‘ì„±
  - í”„ë¡œì íŠ¸ ë¹Œë“œ, ìì„¸í•œ ì‹¤í–‰ ë°©ë²• ëª…ì‹œ
  - êµ¬í˜„ ë°©ë²•ê³¼ ì´ìœ ì— ëŒ€í•œ ê°„ëµí•œ ì„¤ëª…
  - ì™„ë£Œëœ ì‹œìŠ¤í…œì´ ë°°í¬ëœ ì„œë²„ì˜ ì£¼ì†Œ
  - Swaggerë‚˜ Postmanì„ í†µí•œ API í…ŒìŠ¤íŠ¸í• ë•Œ í•„ìš”í•œ ìƒì„¸ ë°©ë²•
  - í•´ë‹¹ ê³¼ì œë¥¼ ì§„í–‰í•˜ë©´ì„œ íšŒê³  ë‚´ìš© ë¸”ë¡œê·¸ í¬ìŠ¤íŒ…
- Swaggerë‚˜ Postmanì„ ì´ìš©í•˜ì—¬ API í…ŒìŠ¤íŠ¸ ê°€ëŠ¥í•˜ë„ë¡ êµ¬í˜„

#### [ê³¼ì œ ì•ˆë‚´]

- 8í¼ì„¼íŠ¸ ê¸°ìˆ ìŠ¤íƒ: Python Django ( ë°±ì—”ë“œë¥¼ 100% Python + Django ìœ¼ë¡œ ìŒ“ì•„ì˜¬ë¦° ì²«ë²ˆì§¸ ê¸ˆìœµíšŒì‚¬ì…ë‹ˆë‹¤. - ì±„ìš©ê³µê³  ä¸­)

#### ğŸ“ ë‹¤ìŒê³¼ ê°™ì€ ë‚´ìš©ì„ í¬í•¨í•˜ëŠ” í…Œì´ë¸”ì„ ì„¤ê³„í•˜ê³  ë‹¤ìŒê³¼ ê°™ì€ ê¸°ëŠ¥ì„ ì œê³µí•˜ëŠ” REST API ì„œë²„ë¥¼ ê°œë°œí•´ì£¼ì„¸ìš”.

#### 1. REST API ê¸°ëŠ¥

- ê±°ë˜ë‚´ì—­ ì¡°íšŒ API
- ì…ê¸ˆ API
- ì¶œê¸ˆ API

#### 2. ê°œë°œ ì¡°ê±´

2-1. ê³ ë ¤ì‚¬í•­

- ê³„ì¢Œì˜ ì”ì•¡ì„ ë³„ë„ë¡œ ê´€ë¦¬í•´ì•¼ í•˜ë©°, ê³„ì¢Œì˜ ì”ì•¡ê³¼ ê±°ë˜ë‚´ì—­ì˜ ì”ì•¡ì˜ ë¬´ê²°ì„±ì˜ ë³´ì¥
- DBë¥¼ ì„¤ê³„ í• ë•Œ ê° ì¹¼ëŸ¼ì˜ íƒ€ì…ê³¼ ì œì•½

2-2. êµ¬í˜„ ì•ˆí•´ë„ ë˜ëŠ” ë¶€ë¶„

- ë¬¸ì œì™€ ê´€ë ¨ë˜ì§€ ì•Šì€ ë¶€ê°€ì ì¸ ì •ë³´. ì˜ˆë¥¼ ë“¤ì–´ ì‚¬ìš©ì í…Œì´ë¸”ì˜ ì´ë©”ì¼, ì£¼ì†Œ, ì„±ë³„ ë“±
- í”„ë¡ íŠ¸ì•¤ë“œ ê´€ë ¨ ë¶€ë¶„

2-3. ì œì•½ì‚¬í•­

- (8í¼ì„¼íŠ¸ê°€ ì§ì ‘ ë¡œì»¬ì—ì„œ ì‹¤í–‰í•˜ì—¬ í…ŒìŠ¤íŠ¸ë¥¼ ì›í•˜ëŠ” ê²½ìš°ë¥¼ ìœ„í•´) í…ŒìŠ¤íŠ¸ì˜ í¸ì˜ì„±ì„ ìœ„í•´ mysql, postgresql ëŒ€ì‹  sqlliteë¥¼ ì‚¬ìš©í•´ ì£¼ì„¸ìš”.

------

### 3. Skill & Tools

- **Skill :** [![img](https://camo.githubusercontent.com/0f3eb5f3e4c61d94657f16605ea420a0216673dfb085d100c458ed15be0599d2/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f507974686f6e2d3337373641423f7374796c653d666f722d7468652d6261646765266c6f676f3d507974686f6e266c6f676f436f6c6f723d7768697465)](https://camo.githubusercontent.com/0f3eb5f3e4c61d94657f16605ea420a0216673dfb085d100c458ed15be0599d2/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f507974686f6e2d3337373641423f7374796c653d666f722d7468652d6261646765266c6f676f3d507974686f6e266c6f676f436f6c6f723d7768697465) [![img](https://camo.githubusercontent.com/c4c1014e1f168ff271282b67ec9059c3cfc16b2a5cba6e0c7c98c3530f47f45c/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f446a616e676f2d3039324532303f7374796c653d666f722d7468652d6261646765266c6f676f3d446a616e676f266c6f676f436f6c6f723d7768697465)](https://camo.githubusercontent.com/c4c1014e1f168ff271282b67ec9059c3cfc16b2a5cba6e0c7c98c3530f47f45c/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f446a616e676f2d3039324532303f7374796c653d666f722d7468652d6261646765266c6f676f3d446a616e676f266c6f676f436f6c6f723d7768697465) [![img](https://camo.githubusercontent.com/9bf3ab62e0f872ed37f7d590e4577137b2dda11ffb0786f9b858cd39c2dc8c7f/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f73716c6974652d3039324532303f7374796c653d666f722d7468652d6261646765266c6f676f3d73716c697465266c6f676f436f6c6f723d23303033423537)](https://camo.githubusercontent.com/9bf3ab62e0f872ed37f7d590e4577137b2dda11ffb0786f9b858cd39c2dc8c7f/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f73716c6974652d3039324532303f7374796c653d666f722d7468652d6261646765266c6f676f3d73716c697465266c6f676f436f6c6f723d23303033423537)
- **Depoly :** [![img](https://camo.githubusercontent.com/9ad32f291fa1163a77cd2e919f8378b38bf66fd9de517178bf890e521178f341/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f415753204543322d3233324633453f7374796c653d666f722d7468652d6261646765266c6f676f3d416d617a6f6e20415753266c6f676f436f6c6f723d7768697465)](https://camo.githubusercontent.com/9ad32f291fa1163a77cd2e919f8378b38bf66fd9de517178bf890e521178f341/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f415753204543322d3233324633453f7374796c653d666f722d7468652d6261646765266c6f676f3d416d617a6f6e20415753266c6f676f436f6c6f723d7768697465) [![img](https://camo.githubusercontent.com/fbef20533fc559c07dcaae57d63beab86709421dfd5428391a563096c88ead5a/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f446f636b65722d3234393645443f7374796c653d666f722d7468652d6261646765266c6f676f3d446f636b6572266c6f676f436f6c6f723d7768697465)](https://camo.githubusercontent.com/fbef20533fc559c07dcaae57d63beab86709421dfd5428391a563096c88ead5a/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f446f636b65722d3234393645443f7374796c653d666f722d7468652d6261646765266c6f676f3d446f636b6572266c6f676f436f6c6f723d7768697465)
- **ETC :** [![img](https://camo.githubusercontent.com/fdb91eb7d32ba58701c8e564694cbe60e706378baefa180dbb96e2c1cfb9ec0f/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f4769742d4630353033323f7374796c653d666f722d7468652d6261646765266c6f676f3d476974266c6f676f436f6c6f723d7768697465)](https://camo.githubusercontent.com/fdb91eb7d32ba58701c8e564694cbe60e706378baefa180dbb96e2c1cfb9ec0f/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f4769742d4630353033323f7374796c653d666f722d7468652d6261646765266c6f676f3d476974266c6f676f436f6c6f723d7768697465) [![img](https://camo.githubusercontent.com/23a917c56e310800a66c58a03447dd42c0dea2abff415ef9719e3e837c1cff82/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f4769746875622d3138313731373f7374796c653d666f722d7468652d6261646765266c6f676f3d476974687562266c6f676f436f6c6f723d7768697465)](https://camo.githubusercontent.com/23a917c56e310800a66c58a03447dd42c0dea2abff415ef9719e3e837c1cff82/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f4769746875622d3138313731373f7374796c653d666f722d7468652d6261646765266c6f676f3d476974687562266c6f676f436f6c6f723d7768697465) [![img](https://camo.githubusercontent.com/879423585ed087f3c973857c43ba7e7d84f52c993d2c937055726339fbf921d9/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f506f73746d616e2d4646364333373f7374796c653d666f722d7468652d6261646765266c6f676f3d506f73746d616e266c6f676f436f6c6f723d7768697465)](https://camo.githubusercontent.com/879423585ed087f3c973857c43ba7e7d84f52c993d2c937055726339fbf921d9/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f506f73746d616e2d4646364333373f7374796c653d666f722d7468652d6261646765266c6f676f3d506f73746d616e266c6f676f436f6c6f723d7768697465)

------

### 4. ëª¨ë¸ë§

[![8persent (1)](https://user-images.githubusercontent.com/61782539/141447955-25afbac0-808d-457e-812d-83b4376d9d90.png)](https://user-images.githubusercontent.com/61782539/141447955-25afbac0-808d-457e-812d-83b4376d9d90.png)

------

### 5. Postman API í…ŒìŠ¤íŠ¸

### API í…ŒìŠ¤íŠ¸ : https://www.postman.com/cloudy-resonance-766003/workspace/8percent/collection/17715735-79c01c1b-885b-48f9-a9a2-1b9b12a24055

ê¸°ë³¸ ì£¼ì†ŒëŠ” ë°°í¬ì£¼ì†Œë¡œ ë˜ì–´ ìˆìœ¼ë©°, ì½œë ‰ì…˜ fork í›„ í…ŒìŠ¤íŠ¸ ë¶€íƒë“œë¦½ë‹ˆë‹¤.

### API ëª…ì„¸ì„œ : https://documenter.getpostman.com/view/17715735/UVC8B5hr

------

### 6. êµ¬í˜„ ì‚¬í•­ ìƒì„¸ ì„¤ëª…

### POST /users/signin (ë¡œê·¸ì¸)

ì´ë©”ì¼ê³¼ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥ë°›ì•„ jwtë¡œ ë³€í™˜í•œ ìœ ì € í† í°ê°’ì„ ë°˜í™˜í•´ì¤ë‹ˆë‹¤.

ë§Œì•½ ì´ë©”ì¼ì´ë‚˜ ë¹„ë°€ë²ˆí˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•Šì„ì‹œ 401 codeë¥¼ return í•´ì¤ë‹ˆë‹¤.

bodyì˜ key ê°’ì´ ì¼ì¹˜í•˜ì§€ ì•Šì„ ì‹œ 400 codeë¥¼ return í•´ì¤ë‹ˆë‹¤.

### POST /deals/int:account_id (ì…ì¶œê¸ˆ)

deal_position í…Œì´ë¸”ì„ ë”°ë¡œ ë¶„ë¦¬í•´ ì…ê¸ˆì€ id=1, ì¶œê¸ˆì€ id=2ë¡œ êµ¬ë¶„ í•˜ì—¬ í•˜ë‚˜ì˜ APIì—ì„œ ì…ì¶œê¸ˆì´ êµ¬í˜„ë˜ë„ë¡ í•˜ì˜€ìŠµë‹ˆë‹¤.

pathë³€ìˆ˜ë¡œ ê³„ì¢Œ idë¥¼ ì‹ë³„í•˜ì—¬ í•´ë‹¹ ê³„ì¢Œì— ì…ì¶œê¸ˆ ìš”ì²­ì„ í•©ë‹ˆë‹¤. í•´ë‹¹ ê³„ì¢Œê°€ ì¡´ì¬í•˜ì§€ ì•Šì„ì‹œ 404 codeë¥¼ return í•©ë‹ˆë‹¤.

í† í°ì˜ userê°€ í•´ë‹¹ ê³„ì¢Œë¥¼ ê°–ê³  ìˆëŠ” userê°€ ì•„ë‹ì‹œ 400 codeë¥¼ return í•´ì¤ë‹ˆë‹¤.

ëˆì„ ì…ê¸ˆí•˜ê±°ë‚˜ ì¶œê¸ˆì‹œ ê±°ë˜ ì‹œê°„, ì…ì¶œê¸ˆ ê¸ˆì•¡, ì”ì—¬ ê¸ˆì•¡, ì ìš”, í•´ë‹¹ ê³„ì¢Œë¥¼ ê±°ë˜ ë‚´ì—­ì— ì¶”ê°€í•˜ì˜€ìŠµë‹ˆë‹¤.

transactionì„ ì ìš©í•˜ì—¬ ê³„ì¢Œì˜ ì”ì•¡ë³€ë™ê³¼ ê±°ë˜ ë‚´ì—­ì˜ ìƒì„±ì´ ì¼ê´„ì ìœ¼ë¡œ ì´ë£¨ì–´ì§€ê³ , ê³„ì¢Œì˜ ì”ì•¡ê³¼ ê±°ë˜ ë‚´ì—­ì˜ ì”ì•¡ ë¬´ê²°ì„±ì´ ìœ ì§€ë˜ë„ë¡ í•˜ì˜€ìŠµë‹ˆë‹¤.

ì”ì—¬ ê¸ˆì•¡ë³´ë‹¤ ë” ë§ì€ ê¸ˆì•¡ì„ ì¶œê¸ˆí•  ì‹œ 400 codeë¥¼ return í•´ì¤ë‹ˆë‹¤.

bodyì˜ key ê°’ì´ ì¼ì¹˜í•˜ì§€ ì•Šì„ ì‹œ 400 codeë¥¼ return í•´ì¤ë‹ˆë‹¤.

ìš”ì²­ì— bodyê°€ ì¡´ì¬í•˜ì§€ ì•Šì„ì‹œ 400 codeë¥¼ return í•©ë‹ˆë‹¤.

bodyì— ë“¤ì–´ì˜¨ deal_psotion_idê°€ ì˜ëª»ë˜ì—ˆì„ ë•Œ 400 codeë¥¼ return í•©ë‹ˆë‹¤.

### GET /deals/int:account_id (ê³„ì¢Œ ê±°ë˜ë‚´ì—­ ì¡°íšŒ)

![](https://user-images.githubusercontent.com/61782539/141475824-d472f981-117c-4e8a-b678-616df1ec4484.png)

pathë³€ìˆ˜ë¡œ ê³„ì¢Œ idë¥¼ ì‹ë³„í•˜ì—¬ í•´ë‹¹ ê³„ì¢Œì˜ ê±°ë˜ë‚´ì—­ì„ ì¡°íšŒí•©ë‹ˆë‹¤. í•´ë‹¹ ê³„ì¢Œê°€ ì¡´ì¬í•˜ì§€ ì•Šì„ì‹œ 404 codeë¥¼ return í•©ë‹ˆë‹¤.

í† í°ì˜ userê°€ í•´ë‹¹ ê³„ì¢Œë¥¼ ê°–ê³  ìˆëŠ” userê°€ ì•„ë‹ì‹œ 400 codeë¥¼ return í•´ì¤ë‹ˆë‹¤.

Query Parameterë¡œ ì¡°íšŒê¸°ê°„ì˜ ì‹œì‘ ë‚ ì§œì™€ ì¢…ë£Œ ë‚ ì§œë¥¼ ë°›ì•„ì™€ì„œ í•´ë‹¹ ê¸°ê°„ì˜ ê±°ë˜ë‚´ì—­ì„ í•„í„°ë§í•©ë‹ˆë‹¤.

ì¡°íšŒê¸°ê°„ì˜ ì‹œì‘ ë‚ ì§œì™€ ì¢…ë£Œ ë‚ ì§œì˜ ì •ë³´ëŠ” í•„ìˆ˜ì ì´ë¯€ë¡œ í•´ë‹¹ keyë“¤ì´ ë“¤ì–´ì˜¤ì§€ ì•Šì•˜ì„ ë•Œ 400 codeë¥¼ return í•©ë‹ˆë‹¤.

ì˜ëª»ëœ ë‚ ì§œ í˜•ì‹ìœ¼ë¡œ ë“¤ì–´ì™”ì„ ë•Œë„ 400 codeë¥¼ return í•©ë‹ˆë‹¤.

Query Parameterì˜ 'sort' keyë¡œ ìµœì‹ ìˆœ, ì˜¤ë˜ëœìˆœ ì •ë ¬ì´ ê°€ëŠ¥í•˜ë„ë¡ í•˜ì˜€ìŠµë‹ˆë‹¤. ë§Œì•½ sort keyê°€ ë“¤ì–´ì˜¤ì§€ ì•Šê±°ë‚˜ ì˜ëª»ëœ Keyë¡œ ë“¤ì–´ì™”ì„ ë•Œ ê¸°ë³¸ ì •ë ¬ì€ ìµœì‹ ìˆœì´ ë˜ë„ë¡ í•˜ì˜€ìŠµë‹ˆë‹¤.

'page' keyë¡œ page ë°ì´í„°ë¥¼ ë°›ì•„ Paginationì´ ê°€ëŠ¥í•˜ë„ë¡ í•˜ì˜€ìŠµë‹ˆë‹¤. 1pageì˜ í¬ê¸°ëŠ” 20ìœ¼ë¡œ ì„¤ì •í•˜ì˜€ìŠµë‹ˆë‹¤. ë§Œì•½ page keyê°€ ë“¤ì–´ì˜¤ì§€ ì•Šê±°ë‚˜ ì˜ëª»ëœ keyë¡œ ë“¤ì–´ì™”ì„ ë•Œ ê¸°ë³¸ pageëŠ” 1ì´ ë˜ë„ë¡ í•˜ì˜€ìŠµë‹ˆë‹¤.

'deal_positin_id' keyë¡œ ì…ê¸ˆë‚´ì—­ë§Œ ì¡°íšŒí•˜ê±°ë‚˜ ì¶œê¸ˆë‚´ì—­ë§Œ ì¡°íšŒí•  ìˆ˜ ìˆë„ë¡ í•„í„°ë§ì´ ê°€ëŠ¥í•˜ë„ë¡ í–ˆìŠµë‹ˆë‹¤. 

ì˜ëª»ëœ deal_position_idê°€ ë“¤ì–´ì™”ì„ ë•Œ 400 codeë¥¼ return í•©ë‹ˆë‹¤.

------

### 7. UnitTest ê²°ê³¼

[![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2021-11-12 á„‹á…©á„’á…® 6 56 58](https://user-images.githubusercontent.com/61782539/141448154-870549e2-ccf1-4328-ac35-794d84f516b8.png)](https://user-images.githubusercontent.com/61782539/141448154-870549e2-ccf1-4328-ac35-794d84f516b8.png)

------

### 8. Functional Testë¥¼ ìœ„í•œ ì‹œë‚˜ë¦¬ì˜¤ ì‘ì„±

ì‹œë‚˜ë¦¬ì˜¤ë³„ ì˜ˆì‹œëŠ” ìƒë‹¨ì— ê¸°ìˆ í•œ Postman TEST urlì—ì„œ TEST í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

- ì‹œë‚˜ë¦¬ì˜¤ : ê¹€ë¯¼í˜¸([user1@8percent.com](mailto:user1@8percent.com))ëŠ” ì˜¤ëŠ˜ ë°›ì€ ì›”ê¸‰ì„ ê³„ì¢Œì— ì…ê¸ˆí•˜ê³ , ë¶€ëª¨ë‹˜ ìš©ëˆì„ ì¶œê¸ˆ í›„ì— ì…ì¶œê¸ˆì´ ì˜ ì´ë£¨ì–´ì¡ŒëŠ”ì§€ ê±°ë˜ë‚´ì—­ì„ í™•ì¸ í•´ë³´ë ¤ê³  í•¨

1. ë¡œê·¸ì¸

â€‹    1-1. ì•„ì´ë”” ì˜¤ì…ë ¥

â€‹    ì´ë©”ì¼ì„ ì˜ëª» ê¸°ì–µí•˜ê³  ìˆì–´ì„œ "[hyoen4@naver.com.com](mailto:hyoen4@naver.com.com)"ë¡œ ì…ë ¥ í›„ ë¡œê·¸ì¸ ì‹œë„

   1-2. ë¹„ë°€ë²ˆí˜¸ ì˜¤ì…ë ¥

â€‹    ë¹„ë°€ë²ˆí˜¸ë¥¼ ë¹ ë¥´ê²Œ ì…ë ¥í•˜ë ¤ë‹¤ê°€ ì‹¤ìˆ˜ë¡œ ì˜ëª»ëœ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥ í›„ ë¡œê·¸ì¸ ì‹œë„

   1-3. ë¡œê·¸ì¸ ì„±ê³µ

â€‹    ì´ë©”ì¼ê³¼ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì˜¬ë°”ë¥´ê²Œ ì…ë ¥í•´ì„œ ë¡œê·¸ì¸ì— ì„±ê³µí–ˆìœ¼ë©°, í† í°ê¹Œì§€ ë°œê¸‰ ì™„ë£Œ

1. ì…ê¸ˆ/ì¶œê¸ˆ

   2-1. ì…ê¸ˆ

â€‹    ë§¤ì›” 12ì¼ì€ ì›”ê¸‰ë‚ ì´ë©°, ì„¸í›„ ìˆ˜ë ¹ì•¡ì€ 2,800,000ì›ì´ë‹¤. 2,800,000ì„ ê³„ì¢Œì— ì…ê¸ˆí•œë‹¤.

   2-2. ì¶œê¸ˆ

   ì˜¤ëŠ˜ ë¶€ëª¨ë‹˜ ìš©ëˆì„ ë“œë¦¬ê¸° ìœ„í•´ì„œ 800,000ì›ì„ ì¶œê¸ˆí•œë‹¤.

   2-3. ì”ì•¡ì´ˆê³¼ê¸ˆì•¡ ì¶œê¸ˆ

â€‹    ì‹¤ìˆ˜ë¡œ ì”ì•¡ë³´ë‹¤ í° ê¸ˆì•¡ì„ ì¶œê¸ˆ ìš”ì²­í•¨.
â€‹    ì´ ë•Œ, ê³„ì¢Œì”ì•¡ì˜ ì´ˆê³¼ê¸ˆì•¡ì„ ì¶œê¸ˆ ìš”ì²­í•œê²ƒì´ê¸° ë•Œë¬¸ì— "INSUFFICIENT_BALANCE"ë¼ëŠ” ë¬¸êµ¬ì™€ í•¨ê»˜ ì—ëŸ¬ì½”ë“œëŠ” 400ì„ ë°˜í™˜

1. ê±°ë˜ë‚´ì—­ ì¡°íšŒ

   3-1. ì…/ì¶œê¸ˆ êµ¬ë¶„ì— ë”°ë¥¸ ì¡°íšŒ

â€‹    ê¹€ë¯¼í˜¸ëŠ” ì…ì¶œê¸ˆì´ ì˜ ì´ë£¨ì–´ì¡ŒëŠ”ì§€ í™•ì¸í•˜ê³ ì ê±°ë˜ë‚´ì—­ì„ ìµœì‹ ìˆœìœ¼ë¡œ ì¡°íšŒí•¨

   3-2. ê±°ë˜ì¼ì‹œì— ë”°ë¥¸ ì¡°íšŒ

â€‹    ê¹€ë¯¼í˜¸ëŠ” 10ì›” 20ì¼ë¶€í„° 1ë…„ ê°€ëŸ‰ ê³„ì¢Œì—ì„œ ì¶œê¸ˆí•œ ê¸ˆì•¡ì´ ì–¼ë§ˆì¸ì§€ ê³„ì‚°í•´ë³´ê³ ì í•´ë‹¹ ê¸°ê°„ì˜ ì¶œê¸ˆ ë‚´ì—­ì„ ì˜¤ë˜ëœìˆœìœ¼ë¡œ ì¡°íšŒí•¨

### 9. ê±°ë˜ë‚´ì—­ì´ 1ì–µê±´ì´ ë„˜ì–´ê°ˆ ê²½ìš°ë¥¼ ëŒ€ë¹„í•œ ì„¤ì •

- #### **VACUUM**

í…Œì´ë¸”ì— ëŒ€ëŸ‰ì˜ ë°ì´í„°ê°€ ìŒ“ì´ë©´ í—ˆìˆ˜ ìš©ëŸ‰ì´ ëŠ˜ì–´ë‚  ìˆ˜ ìˆê³ , ìµœì†Œ 5ë…„~ìµœëŒ€ 10ë…„ë™ì•ˆ ê³ ê°ì˜ ê±°ë˜ë‚´ì—­ì„ ì €ì¥í•˜ê³  ì‚­ì œí•  ìˆ˜ ìˆëŠ” ê·œì • ìƒ í…Œì´ë¸”ì„ ì‚­ì œí•˜ê²Œ ë  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

ë°ì´í„°ì˜ í—ˆìˆ˜ ìš©ëŸ‰ ì°¨ì§€ ë°©ì§€ì™€ ì‚¬ìš©ê³µê°„ í™•ë³´ë¥¼ í‹ˆí‹ˆì´ í•´ì£¼ê¸° ìœ„í•´ `VACUUM`ì„ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤.

ìš°ì„ , ìš©ëŸ‰ í™•ì¸ì„ ìœ„í•´ `manage.py`ê°€ ìˆëŠ” ë””ë ‰í† ë¦¬ì—ì„œ `ls -al`ì„ ì…ë ¥í•´ì¤ë‹ˆë‹¤.

`db.sqlite3`ì˜ íŒŒì¼í¬ê¸°ì— ëŒ€í•œ í™•ì¸ì…ë‹ˆë‹¤.

[![img](https://user-images.githubusercontent.com/88086271/141416947-0d02def3-cfa9-4961-9767-56db730fa91e.png)](https://user-images.githubusercontent.com/88086271/141416947-0d02def3-cfa9-4961-9767-56db730fa91e.png)

`sqlite3`ì„ ì‹¤í–‰í•˜ê³ , ì €ëŠ” ë°ì´í„°ê°€ ê°€ì¥ ë§ì€ í…Œì´ë¸”ì„ ì‚­ì œí–ˆìŠµë‹ˆë‹¤.

[![img](https://user-images.githubusercontent.com/88086271/141417208-c4198d1a-a4ff-44ea-abad-3734fa10674b.png)](https://user-images.githubusercontent.com/88086271/141417208-c4198d1a-a4ff-44ea-abad-3734fa10674b.png)

`sqlite3`ì„ ì¢…ë£Œí•˜ê³  í¬ê¸°ë¥¼ í™•ì¸í•´ë³´ë©´, í…Œì´ë¸”ì„ ì‚­ì œí–ˆìŒì—ë„ ë¶ˆêµ¬í•˜ê³  `db.sqlite3`ì˜ íŒŒì¼í¬ê¸°ëŠ” ê·¸ëŒ€ë¡œì¸ ê±¸ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

[![img](https://user-images.githubusercontent.com/88086271/141417351-521f74a8-8f67-40b5-bdb2-cd7134e6a5e0.png)](https://user-images.githubusercontent.com/88086271/141417351-521f74a8-8f67-40b5-bdb2-cd7134e6a5e0.png)

`sqlite3`ì— ì ‘ì†í•´ì„œ `vacuum`ì„ ì…ë ¥ í›„ ë‹¤ì‹œ ë‚˜ì™€ì„œ `ls -al`ì„ ì…ë ¥í•´ë³´ë©´ 159,000ì—ì„œ 69,000ìœ¼ë¡œ ê°ì†Œí•œ ê²ƒì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì´ë ‡ê²Œ í…Œì´ë¸” ìµœì í™”ë¥¼ í†µí•´ ìœ íš¨ ë°ì´í„°ë§Œ ê´€ë¦¬ë  ìˆ˜ ìˆë„ë¡ VACUUMì„ ìš°ì„ ìœ¼ë¡œ ì„¤ì •í–ˆìŠµë‹ˆë‹¤.

[![img](https://user-images.githubusercontent.com/88086271/141417656-d8132fdf-0c46-4115-a6e1-cb5696665529.png)](https://user-images.githubusercontent.com/88086271/141417656-d8132fdf-0c46-4115-a6e1-cb5696665529.png)

- #### **Indexing**

![](https://user-images.githubusercontent.com/61782539/141482697-6ff59772-441a-4a9a-95f3-7734127ceb64.png)

ê±°ë˜ë‚´ì—­ì„ ì¡°íšŒí•  ë•Œ filterì™€ order_byì— ì‚¬ìš©ë˜ëŠ” created_at í•„ë“œì— indexê°€ ìƒì„±ë˜ë„ë¡ í•˜ì—¬ í…Œì´ë¸”ì˜ ë°ì´í„°ê°€ ë§ì•„ë„ ë¹ ë¥¸ ê²€ìƒ‰ì´ ê°€ëŠ¥í•˜ë„ë¡ ë³´ì™„í•˜ì˜€ìŠµë‹ˆë‹¤.

- #### partitioning

ì´ë²ˆ ê³¼ì œë¥¼ ì§„í–‰í•˜ë©´ì„œ, 1ì–µê±´ì´ ë„˜ëŠ” ë°ì´í„°ê°€ ìƒì„±ë˜ì—ˆì„ ë•Œ í…Œì´ë¸”ì— ëŒ€í•œ ê´€ë¦¬ë¥¼ ê³ ë¯¼í•˜ë©´ì„œ íŒŒí‹°ì…”ë‹ì— ëŒ€í•œ ê°œë…ì„ ì²˜ìŒ ì ‘í•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤. 1ì–µê±´ì´ ë„˜ëŠ” ê±°ë˜ë‚´ì—­ì„ ê±°ë˜ê¸°ê°„ì— ë”°ë¼ RANGE PARTITIONì„ ì ìš©í•˜ì—¬ ì—¬ëŸ¬ê°œì˜ í…Œì´ë¸”ë¡œ ë‚˜ëˆ„ì–´ ì €ì¥í•˜ë©´, ë…¼ë¦¬ì ìœ¼ë¡œëŠ” í•˜ë‚˜ì˜ í…Œì´ë¸”ì²˜ëŸ¼ ë³´ì´ì§€ë§Œ DBMS ë‚´ë¶€ì ìœ¼ë¡œ ê±°ë˜ì¼ìì— ë”°ë¼ ê° íŒŒí‹°ì…˜ì˜ ë°ì´í„°ë¥¼ ì¡°íšŒí•˜ë¯€ë¡œ ë§Œì•½ í•´ë‹¹ ê±°ë˜ê¸°ê°„ì´ ì†í•œ í…Œì´ë¸”ì— ë°ì´í„°ê°€ 500ë§Œê±´ì´ë¼ê³  í•˜ë©´ 500ë§Œê±´ì˜ ë°ì´í„°ê°€ ìˆëŠ” í…Œì´ë¸”ë§Œ ì¡°íšŒí•  ìˆ˜ ìˆê²Œ ë©ë‹ˆë‹¤. ë˜ RANGE PARTITIONì€ ë°ì´í„° ë³´ê´€ì£¼ê¸°ë¥¼ ê´€ë¦¬í•  ë•Œ ë³´ê´€ê¸°ê°„ì´ ì§€ë‚œ íŒŒí‹°ì…˜ í…Œì´ë¸”ë§Œ ì‚­ì œí•˜ë©´ ë˜ê¸° ë•Œë¬¸ì— ê¸ˆìœµê±°ë˜ ë‚´ì—­ì„ ê´€ë¦¬í•˜ëŠ”ë°ë„ ìœ ìš©í•˜ê²Œ ì‚¬ìš©ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.



íŒŒí‹°ì…”ë‹ì„ í”„ë¡œì íŠ¸ì— ì ìš©í•´ë³´ê¸° ìœ„í•´ Architect íŒ¨í‚¤ì§€ë¥¼ ì‚¬ìš©í•´ë³´ì•˜ìŠµë‹ˆë‹¤. 

```python
from django.db import models
import architect

@architect.install('partition', type='range', subtype='integer',
                   constraint='100', column='id')
class User(models.Model):
    name     = models.CharField(max_length = 50)
    email    = models.CharField(max_length = 200, unique = True)
    password = models.CharField(max_length = 500)

    class Meta:
        db_table = 'users'
    
    def __str__(self):
        return self.name
```

ë¨¼ì € ì˜ ì ìš©ì´ ë˜ëŠ”ì§€ í™•ì¸í•˜ê¸° ìœ„í•´ User ëª¨ë¸ì— ì ìš© í›„ì— ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì˜€ìŠµë‹ˆë‹¤.

```
architect partition --module users.models
architect partition: result: successfully (re)configured the database for the following models: User
```

í›„ì— constraintì— ì„¤ì •ëœ ë²”ìœ„ì— ë”°ë¼ ì—¬ëŸ¬ ë²”ìœ„ì˜ idê°’ì„ ê°€ì§„ userë¥¼ ìƒì„±í•´ë³´ì•˜ì§€ë§Œ User í…Œì´ë¸”ì— íŒŒí‹°ì…˜ì´ ì ìš©ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.

 Architectì˜ ê³µì‹ë¬¸ì„œë¥¼ ì°¾ì•„ë³´ë‹ˆ PostgreSQLê³¼ MySQL ë‘ dbë¥¼ ì§€ì›í•˜ê³  sqlite3ëŠ” ì§€ì›í•˜ì§€ ì•ŠëŠ” ê²ƒìœ¼ë¡œ ë³´ì˜€ìŠµë‹ˆë‹¤.

- Supported DBs
  - [PostgreSQL](https://www.postgresql.org/) >= 8.0
  - [MySQL](https://www.mysql.com/) >= 5.5

django-db-parti https://pypi.org/project/django-db-parti/ ë¼ëŠ” ë‹¤ë¥¸ íŒ¨í‚¤ì§€ë„ ì°¾ì•„ë³´ì•˜ì§€ë§Œ í•´ë‹¹ íŒ¨í‚¤ì§€ë„ PostgreSQLê³¼ MySQLë§Œ ì§€ì›í•˜ì˜€ìŠµë‹ˆë‹¤.



ì €í¬ íŒ€ì€ ì‹œê°„ì´ ì–¼ë§ˆ ë‚¨ì§€ ì•Šì€ ìƒí™©ì—ì„œ ì°¨ë¼ë¦¬ ëª¨ë¸ë§ ì°¨ì›ì—ì„œë¼ë„ í•˜ë‚˜ì˜ í…Œì´ë¸”ë¡œ ê´€ë¦¬ë˜ë˜ ê±°ë˜ë‚´ì—­ í…Œì´ë¸”ì„ ë…„ë„ì— ë”°ë¼ ë”°ë¡œ ìƒì„±í•˜ì—¬ ê´€ë¦¬í•˜ëŠ” ê²ƒìœ¼ë¡œ ë¯¸ì•½í•˜ê²Œë‚˜ë§ˆ êµ¬í˜„í•´ë³´ëŠ” ê²ƒì´ ì¢‹ê² ë‹¤ê³  íŒë‹¨í•˜ì˜€ìŠµë‹ˆë‹¤. ë”°ë¼ì„œ deals í…Œì´ë¸”ì„ 2021ë…„ ê±°ë˜ë‚´ì—­ì´ ì €ì¥ë¼ìˆëŠ” deals2021 í…Œì´ë¸”ê³¼ 2020ë…„ ê±°ë˜ë‚´ì—­ì´ ì €ì¥ë¼ìˆëŠ” deals2020 í…Œì´ë¸”ë¡œ ë¶„í• ë˜ë„ë¡ ëª¨ë¸ì„ ìˆ˜ì •í•˜ì˜€ìŠµë‹ˆë‹¤.

![](https://user-images.githubusercontent.com/61782539/141502990-2fc032aa-e997-4e72-9261-60ba96e9e84b.png)

deals2020 í…Œì´ë¸”ì—ëŠ” 2020ë…„ë„ì— ìƒì„±ëœ ê±°ë˜ë‚´ì—­ ë°ì´í„°ë§Œ ì €ì¥ë¼ìˆìŠµë‹ˆë‹¤.

![](https://user-images.githubusercontent.com/61782539/141503320-74a2b342-529c-4da1-a496-a2d4d3035722.png)

deals2021 í…Œì´ë¸”ì—ëŠ” 2021ë…„ë„ì— ìƒì„±ëœ ê±°ë˜ë‚´ì—­ ë°ì´í„°ë§Œ ì €ì¥ë¼ìˆìŠµë‹ˆë‹¤.



ì´ë ‡ê²Œ ëª¨ë¸ë§ì„ ìˆ˜ì •í•œ í›„ì— ê±°ë˜ë‚´ì—­ì„ ì¡°íšŒí•˜ëŠ” APIì—ì„œ ì¡°íšŒí•œ ê±°ë˜ê¸°ê°„ì˜ ì‹œì‘ë‚ ì§œ ì—°ë„ê°€ 2020ë…„ì¼ ë•Œë§Œ deals2020 í…Œì´ë¸”ì— ì ‘ê·¼í•˜ì—¬ ì¡°íšŒí•œ ê¸°ê°„ì— í¬í•¨ë˜ëŠ” ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ê³ , ì¡°íšŒí•œ ê¸°ê°„ì´ 2021ë…„ì— êµ­í•œë˜ë©´ deals2021 í…Œì´ë¸”ì˜ ë°ì´í„°ì—ë§Œ ì ‘ê·¼í•˜ë„ë¡ êµ¬í˜„í•˜ì—¬ ë§ì€ ì–‘ì˜ ê±°ë˜ë‚´ì—­ì„ ë¶„í• í•˜ì—¬ ì ‘ê·¼í•  ìˆ˜ ìˆê²Œ í•˜ì˜€ìŠµë‹ˆë‹¤. ë˜ 2020ë…„ ë°ì´í„°ì˜ ë³´ê´€ê¸°ê°„ì´ ì§€ë‚¬ë‹¤ê³  í–ˆì„ ë•Œ í•´ë‹¹ í…Œì´ë¸”ì˜ ë°ì´í„°ë§Œ ì‚­ì œí•˜ë©´ ë˜ê¸° ë•Œë¬¸ì— ë°ì´í„° ê´€ë¦¬ê°€ ì¢€ ë” ìš©ì´í•  ê²ƒ ê°™ìŠµë‹ˆë‹¤.



2020-04-02 ~ 2021-11-12 ê±°ë˜ë‚´ì—­ ì¡°íšŒ

```
/deals/1?start_date=2020-04-02&end_date=2021-11-12&sort=old&deal_position_id=&page=2
```

```sql
2021-11-13 02:31:37,353 DEBUG (0.095) SELECT "deals2020"."id", "deals2020"."account_id", "deals2020"."deal_position_id", "deals2020"."amount", "deals2020"."created_at", "deals2020"."balance", "deals2020"."description", "deal_positions"."id", "deal_positions"."position" FROM "deals2020" INNER JOIN "deal_positions" ON ("deals2020"."deal_position_id" = "deal_positions"."id") WHERE (django_datetime_cast_date("deals2020"."created_at", NULL, NULL) BETWEEN '2020-04-02' AND '2021-11-12' AND "deals2020"."account_id" = 1) ORDER BY "deals2020"."created_at" ASC; args=('2020-04-02', '2021-11-12', 1)
2021-11-13 02:31:37,716 DEBUG (0.068) SELECT "deals2021"."id", "deals2021"."account_id", "deals2021"."deal_position_id", "deals2021"."amount", "deals2021"."created_at", "deals2021"."balance", "deals2021"."description", "deal_positions"."id", "deal_positions"."position" FROM "deals2021" INNER JOIN "deal_positions" ON ("deals2021"."deal_position_id" = "deal_positions"."id") WHERE (django_datetime_cast_date("deals2021"."created_at", NULL, NULL) BETWEEN '2020-04-02' AND '2021-11-12' AND "deals2021"."account_id" = 1) ORDER BY "deals2021"."created_at" ASC; args=('2020-04-02', '2021-11-12', 1)
[13/Nov/2021 02:31:38] "GET /deals/1?start_date=2020-04-02&end_date=2021-11-12&sort=old&deal_position_id=&page=2 HTTP/1.1" 200 3548
```

deals2020 í…Œì´ë¸”ê³¼ deals2021í…Œì´ë¸”ì— ì ‘ê·¼í•©ë‹ˆë‹¤.



2021-04-02 ~ 2021-11-12 ê±°ë˜ë‚´ì—­ ì¡°íšŒ

```
deals/1?start_date=2021-04-02&end_date=2021-11-12&sort=old&deal_position_id=&page=1
```

```sql
2021-11-13 02:34:27,308 DEBUG (0.099) SELECT "deals2021"."id", "deals2021"."account_id", "deals2021"."deal_position_id", "deals2021"."amount", "deals2021"."created_at", "deals2021"."balance", "deals2021"."description", "deal_positions"."id", "deal_positions"."position" FROM "deals2021" INNER JOIN "deal_positions" ON ("deals2021"."deal_position_id" = "deal_positions"."id") WHERE (django_datetime_cast_date("deals2021"."created_at", NULL, NULL) BETWEEN '2021-04-02' AND '2021-11-12' AND "deals2021"."account_id" = 1) ORDER BY "deals2021"."created_at" ASC; args=('2021-04-02', '2021-11-12', 1)
[13/Nov/2021 02:34:27] "GET /deals/1?start_date=2021-04-02&end_date=2021-11-12&sort=old&deal_position_id=&page=1 HTTP/1.1" 200 3550
```

deals2021 í…Œì´ë¸”ì—ë§Œ ì ‘ê·¼í•©ë‹ˆë‹¤.

### 10. Reference

ì´ í”„ë¡œì íŠ¸ëŠ” ì›í‹°ë“œxìœ„ì½”ë“œ ë°±ì—”ë“œ í”„ë¦¬ì˜¨ë³´ë”© ê³¼ì œ ì¼í™˜ìœ¼ë¡œ 8í¼ì„¼íŠ¸(eightpercent)ì—ì„œ ì¶œì œí•œ ê³¼ì œë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤. ê°ì‚¬í•©ë‹ˆë‹¤.
